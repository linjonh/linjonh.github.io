---
title: 17.ä¸šåŠ¡ç¯‡-ç®€å†æ•°æ®å­˜æ¡£ä¸”è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤šçª—å£
date: 2025-11-03T23:13:28+08:00
description: "ElectronReactä»0åˆ°1å®ç°ç®€å†å¹³å°å®æˆ˜ï¼Œ17.ä¸šåŠ¡ç¯‡-ç®€å†æ•°æ®å­˜æ¡£ä¸”è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤šçª—å£"
categories: ['æ˜é‡‘å°å†Œ']
tags: ['æ˜é‡‘å°å†Œ','è¯¾ç¨‹']
artid: "1741706017"
image:
    path: https://bing.ee123.net/img/rand?artid=1741706017
    alt: 17.ä¸šåŠ¡ç¯‡-ç®€å†æ•°æ®å­˜æ¡£ä¸”è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤šçª—å£
featuredImage: https://bing.ee123.net/img/rand?artid=1741706017
featuredImagePreview: https://bing.ee123.net/img/rand?artid=1741706017
cover: https://bing.ee123.net/img/rand?artid=1741706017
image: https://bing.ee123.net/img/rand?artid=1741706017
img: https://bing.ee123.net/img/rand?artid=1741706017
---

## å‰è¨€

æœ¬ç« èŠ‚å°†å®ç°**å¤š Webpack å…¥å£ã€å¤šæµè§ˆå™¨çª—å£**è¿›è¡Œå®è·µè®¾ç½®æ¨¡å—ï¼Œå¹¶å®ç°è‡ªå®šä¹‰ç®€å†æ•°æ®çš„æœ¬åœ°å­˜æ¡£ï¼Œå¦‚æœä½ å¯¹æœ¬ç« èŠ‚å†…å®¹å…´è¶£ä¸å¤§ï¼Œå¯ä»¥å¿«é€Ÿé˜…è¯»æˆ–è·³è¿‡ã€‚

## æ˜ç¡®å®šä½

æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ª`è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„`åŠŸèƒ½ï¼Œçœ‹èµ·æ¥å®ƒæ›´åƒæ˜¯ä¸€ä¸ªå®Œæ•´ç‹¬ç«‹çš„æ¨¡å—ï¼Œå¯¹æ•´ä¸ªåº”ç”¨æ¥è®²ï¼Œå¤šå®ƒå¦‚è™æ·»ç¿¼ï¼Œå°‘å®ƒä¹Ÿæ— ä¼¤å¤§é›…ã€‚

æ‰€ä»¥æˆ‘æœŸæœ›ï¼šå°†æ¥å¯¹è¯¥æ¨¡å—çš„è¿ç§»ã€æ”¹åŠ¨ï¼Œç”šè‡³åˆ é™¤ï¼Œæ˜¯ä¸ä¼šå½±å“ä¸»æµç¨‹åŠŸèƒ½ã€‚

æ‰€ä»¥å°†å®ƒå†™æˆä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—çœ‹èµ·æ¥æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œé€šè¿‡å¯¹å¸‚é¢ä¸Šçš„ä¸€äº› PC åº”ç”¨åšè°ƒç ”ï¼Œæˆ‘å‘ç°ï¼Œåº”ç”¨è®¾ç½®éƒ½æ˜¯**æ–°å¼€ä¸€ä¸ªçª—å£**è¿›è¡Œå±•ç¤ºï¼Œè¿™è¾¹æˆ‘ä¹Ÿé‡‡ç”¨æ­¤æ–¹å¼è¿›è¡Œå®ç°ã€‚

## æ ¸å¿ƒé—®é¢˜

é€šè¿‡å‰è¾¹çš„å®è·µï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸»è¿›ç¨‹ä¸­åªåˆ›å»ºäº†ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ä¸”å¯¹åº”ä¸€ä¸ªæµè§ˆå™¨çª—å£ã€‚

å¦‚æœä½ è®¤çœŸçœ‹ç¬¬äºŒç« èŠ‚ï¼Œæƒ³å¿…ä½ è¿˜æœ‰å°è±¡ï¼š**æ¸²æŸ“è¿›ç¨‹çš„å…¥å£æ˜¯ä¸€ä¸ª HTML æ–‡ä»¶**ã€‚å¤šè¯´æ— ç›Šï¼Œç›´æ¥ä¸Šä»£ç (éƒ¨åˆ†ä»£ç çœç•¥ï¼Œåªæ ‡æ³¨å…³é”®ä»£ç )ï¼Œçœ‹ä»£ç çš„æ³¨é‡Š

```js
// webpack/webpack.render.dev.js
const devConfig = {
  // ğŸ‘‰ ç¬¬ä¸€æ­¥ï¼šæˆ‘ä»¬æŒ‡å®šäº†å…¥å£æ–‡ä»¶ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å•å…¥å£æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬åˆ¶å®š app.tsx
  entry: {
    index: path.resolve(__dirname, '../app/renderer/app.tsx'),
  },
  // ğŸ‘‰ ç¬¬äºŒæ­¥ï¼šæˆ‘ä»¬æŒ‡å®šå¯¼å‡ºçš„æ–‡ä»¶åç§°å’Œå¯¼å‡ºçš„æ–‡ä»¶è·¯å¾„
  output: {
    filename: '[name].[hash].js',
    path: path.resolve(__dirname, '../dist'),
  },
  // ğŸ‘‰ ç¬¬ä¸‰æ­¥ï¼šæˆ‘ä»¬é€šè¿‡ dev-server å¼€äº†ä¸€ä¸ªæœ¬åœ°çš„æœåŠ¡ï¼Œé€šè¿‡ http://127.0.0.1:7001/index.html å°±èƒ½è®¿é—®é¡µé¢
  devServer: {
    host: '127.0.0.1',
    port: 7001,
  },
  // ğŸ‘‰ ç¬¬å››æ­¥ï¼šæˆ‘ä»¬æŒ‡å®šäº†è‡ªåŠ¨ç”Ÿæˆ HTML çš„æ¨¡ç‰ˆï¼Œå¹¶ä¸”å£°æ˜æ‰“åŒ…åçš„æ¨¡ç‰ˆåç§°
  plugins: [
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, '../app/renderer/index.html'),
      filename: path.resolve(__dirname, '../dist/index.html'),
      chunks: ['index'],
    }),
  ],
};
```

é€šè¿‡ä¸Šè¿°çš„ä»£ç è§£è¯»ï¼Œæƒ³å¿…å¤§å®¶éƒ½èƒ½ç†è§£è¿™æ®µ Webpack çš„é…ç½®ä»¥åŠæœ€ç»ˆçš„æ‰“åŒ…ç»“æœï¼Œæœ€åçš„æˆ‘ä»¬ä¸»è¿›ç¨‹ä¸­ï¼Œåªéœ€è¦é€šè¿‡ `loadURL('http://127.0.0.1/index.html')` åŠ è½½é“¾æ¥å³å¯ã€‚

é—®é¢˜éšä¹‹è€Œæ¥ï¼Œæˆ‘ä»¬æœŸæœ›â€œåº”ç”¨è®¾ç½®â€æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„çª—å£ï¼Œä¹Ÿå°±æ˜¯å†æ–°å¢ä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚è€Œæ¸²æŸ“è¿›ç¨‹çš„å…¥å£æ˜¯ä¸€ä¸ª HTML æ–‡ä»¶ï¼Œç­‰ä»·äºæˆ‘ä»¬åœ¨ Webpack æ‰“åŒ…æ—¶ï¼Œéœ€è¦æ‰“åŒ…ä¸€ä»½ `setting.html`ï¼Œè¿™æ ·æˆ‘ä»¬æ–°å¢åŠ çš„çª—å£åªéœ€è¦ `loadURL('http://127.0.0.1/setting.html')` å³å¯ã€‚

**æ‰€ä»¥æœ€æ ¸å¿ƒçš„é—®é¢˜åœ¨äºï¼šå¦‚ä½•å®ç° Webpack çš„å¤šå…¥å£æ‰“åŒ…ã€‚**

## å¼€å§‹å®è·µ

ç”±äºå‰æœŸæˆ‘ä»¬ä¸æ–­å¼€å‘ï¼Œé¡¹ç›®å·²ç»æœ‰äº†é›å½¢ï¼Œæ­¤æ—¶ä¸å®œæ”¹åŠ¨æ–‡ä»¶ç›®å½•ç»“æ„ã€‚ç…§ç›®å‰æƒ…å†µæ¥çœ‹ï¼Œæœ€å¥½çš„æ–¹å¼è«è¿‡äºå°†æ–°çª—å£çš„ç›¸å…³ä»£ç è¿›è¡Œåˆ†å‰²ã€‚

### ç¬¬ä¸€æ­¥ï¼šç‹¬ç«‹æ–‡ä»¶å¤¹ç®¡ç†

æˆ‘ä»¬åœ¨ renderer æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å¢ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå–åä¸ºï¼š`windowPages`ï¼Œæ„å‘³ç€æ­¤æ–‡ä»¶å¤¹æ˜¯ä¹‹åæ‰€æœ‰æ–°å¢çª—å£çš„æ¨¡å—ä»£ç ã€‚

æ¥ç€åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå–åä¸º settingï¼Œè¿™æ˜¯æˆ‘ä»¬åº”ç”¨è®¾ç½®çš„ä»£ç æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶æ–‡ä»¶å¤¹ä¸‹è¿½åŠ  `app.tsx`ã€`index.tsx`ã€`index.less`ã€`index.html`ï¼Œé€šè¿‡ä¸‹å›¾å¯ä»¥çœ‹åˆ°ç°åœ¨çš„æ–‡ä»¶ç»“æ„

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/093bee154a5144099f4151bc2e0de53c~tplv-k3u1fbpfcp-watermark.image)

### ç¬¬äºŒæ­¥ï¼šç¼–å†™ setting ç›¸å…³ä»£ç 

è¿›å…¥ `renderer/windowPages/setting` æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬ç¼–å†™ `app.tsx` æ–‡ä»¶

```ts
// renderer/windowPages/setting/app.tsx
import React from 'react';
import ReactDOM from 'react-dom';
// ğŸ‘‡ å¼•å…¥Redux
import { Provider } from 'react-redux';
import store from '@src/store';
// ğŸ‘‡ åº”ç”¨è®¾ç½®çš„å…¥å£ç»„ä»¶
import Setting from './index';

function App() {
  return (
    <Provider store={store}>
      <Setting />
    </Provider>
  );
}

ReactDOM.render(<App />, document.getElementById('root'));
```

ç´§æ¥ç€æˆ‘ä»¬ç¼–å†™ä¸€ä¸‹ `index.tsx`ï¼Œç®€çŸ­çš„å†™ä¸‹ä¸¤è¡Œä»£ç 

```ts
// renderer/windowPages/setting/index.tsx
import React from 'react';

function Setting() {
  return <div>åº”ç”¨è®¾ç½®-æ–°çª—å£</div>;
}

export default Setting;
```

å†ä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬åº”ç”¨è®¾ç½®çš„ HTML å…¥å£æ¨¡ç‰ˆä»£ç 

```ts
// renderer/windowPages/setting/index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åº”ç”¨è®¾ç½®</title>
    <style>
      * {
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
```

### ç¬¬ä¸‰æ­¥ï¼šç¼–å†™ Webpack é…ç½®

æˆ‘ä»¬è¿›å…¥ `webpack/webpack.render.dev.js` æ–‡ä»¶ï¼Œä¸ºå…¶æ–°å¢ä¸€ä¸ªæ‰“åŒ…å…¥å£ï¼ˆéƒ¨åˆ†ä»£ç çœç•¥ï¼‰

```js
// webpack/webpack.render.dev.js

const devConfig = {
  // ğŸ‘‡ è¿™é‡Œå®šä¹‰å¤š entry
  entry: {
    index: path.resolve(__dirname, '../app/renderer/app.tsx'),
    setting: path.resolve(__dirname, '../app/renderer/windowPages/setting/app.tsx'),
  },
  // ğŸ‘‡ è¿™é‡Œå®šä¹‰å¤šä¸ª htmlHtmlPlugin
  plugins: [
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, '../app/renderer/index.html'),
      filename: path.resolve(__dirname, '../dist/index.html'),
      chunks: ['index'],
    }),
    new HtmlWebpackPlugin({
      template: path.resolve(__dirname, '../app/renderer/windowPages/setting/index.html'),
      filename: path.resolve(__dirname, '../dist/setting.html'),
      chunks: ['setting'],
    }),
  ],
};
```

æˆ‘ä»¬é€šè¿‡è¿è¡Œ `npm run start:render` æ¥ç§ç§ï¼Œæ˜¯ä¸æ˜¯ä¼šæ‰“åŒ…ä¸€ä»½åä¸º `setting.html` æ–‡ä»¶å‘¢ï¼Ÿ

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/288d42df432e4d8ea719d025377cd36d~tplv-k3u1fbpfcp-watermark.image)

### ç¬¬å››æ­¥ï¼šç¼–å†™ä¸»è¿›ç¨‹

æˆ‘ä»¬æ–°å¢äº†â€œåº”ç”¨è®¾ç½®â€æ¨¡å—çš„çª—å£ä»£ç ï¼Œä¹Ÿåœ¨ Webpack ä¸­å®šä¹‰äº†å¤šå…¥å£ï¼Œå¹¶ä¸”æ‰“åŒ…ä¹Ÿå­˜åœ¨æ­¤ HTML æ–‡ä»¶ï¼Œè¯ä¸å¤šè¯´ï¼Œæ–°å¢çª—å£åŠ è½½æ­¤ HTML æ–‡ä»¶å§ã€‚

æˆ‘ä»¬è¿›å…¥ `app/main/electron.ts` ä¸­ç¨ä½œä¿®æ”¹

```ts
// app/main/electron.ts

function createWindow() {
  // åˆ›å»ºä¸»åº”ç”¨çª—å£
  const mainWindow = new BrowserWindow({
    width: 1200,
    height: 800,
    webPreferences: {
      devTools: true,
      nodeIntegration: true,
    },
  });

  // åˆ›å»ºåº”ç”¨è®¾ç½®çª—å£
  const settingWindow = new BrowserWindow({
    width: 720,
    height: 240,
    resizable: false, // ğŸ‘ˆ æˆ‘ä»¬è®¾ç½®è¯¥çª—å£ä¸å¯æ‹‰ä¼¸å®½é«˜
    webPreferences: {
      devTools: true,
      nodeIntegration: true,
    },
  });

  if (isDev()) {
    mainWindow.loadURL(`http://127.0.0.1:7001/index.html`);
    settingWindow.loadURL(`http://127.0.0.1:7001/setting.html`);
  } else {
    mainWindow.loadURL(`file://${path.join(__dirname, '../dist/index.html')}`);
    settingWindow.loadURL(`file://${path.join(__dirname, '../dist/setting.html')}`);
  }
}
```

### ç¬¬äº”æ­¥ï¼šè¿è¡Œ

æ¥ä¸‹æ¥ï¼Œé€šè¿‡è¿è¡Œåº”ç”¨ï¼Œçœ‹çœ‹æ˜¯å¦æ•ˆæœå¦‚æˆ‘ä»¬æ‰€æœŸæœ›çš„ä¸€æ ·

```bash
npm run start:render
npm run start:main
```

æœ€ç»ˆæ•ˆæœï¼Œå¯ä»¥çœ‹åˆ°ä¼šå­˜åœ¨ä¸¤ä¸ªçª—å£ï¼Œå¹¶ä¸”æ–°å¢çš„â€œåº”ç”¨è®¾ç½®â€çª—å£å¦‚æˆ‘ä»¬æ‰€æœŸæœ›çš„ä¸€æ ·ã€‚å¯çœ‹æ­¤ [ğŸ‘‰ commit](https://github.com/PDKSophia/visResumeMook/commit/26926466bfd27184d236a87ed11855a9565c999f)

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c0ba367c61234a74acb6c7d326a7d51a~tplv-k3u1fbpfcp-watermark.image)

## åº”ç”¨è®¾ç½®æ¨¡å—ä»£ç å®ç°

é€šè¿‡ä¸Šè¾¹å®è·µï¼Œæˆ‘ä»¬å®Œæˆäº†â€œåº”ç”¨è®¾ç½®â€çª—å£çš„åˆ›å»ºï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å®ç°ä¸€ä¸‹å…·ä½“åŠŸèƒ½ã€‚å…ˆçœ‹ä¸€ä¸‹åŸå‹ç¨¿

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2666b219bfbb4d5ca19246d50c16a1b8~tplv-k3u1fbpfcp-watermark.image)

çœ‹èµ·æ¥å¹¶ä¸éº»çƒ¦ï¼Œ æˆ‘ä»¬å…ˆåœ¨ `windowPages/setting/index.tsx` ä¸­å†™ä¸‹è¿™æ®µä»£ç ï¼Œæ ·å¼ä»£ç å¿½ç•¥

```ts
// renderer/windowPages/setting/index.tsx

import React, { useState } from 'react';
import './index.less';
import MyButton from '@common/components/MyButton';

function Setting() {
  const [resumeSavePath, setResumeSavePath] = useState('');

  const onSave = () => {};
  return (
    <div styleName="container">
      <p styleName="label">ä¿®æ”¹ç®€å†æ•°æ®å‚¨å­˜è·¯å¾„</p>
      <div styleName="input">
        <div styleName="value">{resumeSavePath || 'å½“å‰å­˜å‚¨è·¯å¾„ä¸ºï¼š'}</div>
        <div styleName="update-btn">æ›´æ”¹è·¯å¾„</div>
      </div>
    </div>
  );
}

export default Setting;
```

åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œå¯ä»¥çœ‹åˆ°æ•ˆæœ

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5de2a1e20844de99923261eae3622e9~tplv-k3u1fbpfcp-watermark.image)

é™æ€æ•ˆæœå·²è¢«æˆ‘ä»¬å®ç°ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ä¸»é€»è¾‘ï¼š**è¿›è¡Œæ›´æ¢è·¯å¾„**ã€‚é€šè¿‡ Electron æä¾›çš„ [dialog](https://www.electronjs.org/docs/api/dialog#dialogshowsavedialogsyncbrowserwindow-options) æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ–‡ä»¶çš„æ‰“å¼€å’Œä¿å­˜ï¼Œæ¥ä¸‹æ¥è¯•è¯•.

```ts
// renderer/windowPages/setting/index.tsx

import React, { useState } from 'react';
import './index.less';
import MyButton from '@common/components/MyButton';

function Setting() {
  const [resumeSavePath, setResumeSavePath] = useState('');

  const onChangePath = () => {
    // 1. å‘ä¸»è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œå› ä¸º dialog æ¨¡å—åªèƒ½åœ¨ä¸»è¿›ç¨‹ä¸­è°ƒç”¨
    ipcRenderer.send('open-save-resume-path', '');
    // 2. ç›‘å¬ä»ä¸»è¿›ç¨‹å‘é€å›æ¥çš„æ¶ˆæ¯
    ipcRenderer.on('reply-save-resume-path', (event, arg: string[]) => {
      if (arg) {
        if (arg.length > 0) setResumeSavePath(arg[0]);
      } else {
        console.log('è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤±è´¥');
      }
    });
  };

  return (
    <div styleName="container">
      <p styleName="label">ä¿®æ”¹ç®€å†æ•°æ®å‚¨å­˜è·¯å¾„</p>
      <div styleName="input">
        <div styleName="value">{resumeSavePath || 'å½“å‰å­˜å‚¨è·¯å¾„ä¸ºï¼š'}</div>
        <div styleName="update-btn" onClick={onChangePath}>
          æ›´æ”¹è·¯å¾„
        </div>
      </div>
    </div>
  );
}

export default Setting;
```

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº† `onChangePath` æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­é€šè¿‡ IPC çš„æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚ä¸ºä»€ä¹ˆè¿›è¡Œé€šä¿¡ï¼Ÿå› ä¸º `dialog` æ¨¡å—åªèƒ½ä½œç”¨äºä¸»è¿›ç¨‹ï¼Œæˆ‘ä»¬åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¥ç€å»ä¿®æ”¹ä¸€ä¸‹ä¸»è¿›ç¨‹ï¼Œæ·»åŠ ä¸‹é¢è¿™æ®µä»£ç 

```ts
// app/main/electron.ts

// åº”ç”¨è®¾ç½®ï¼Œä¿å­˜è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„
ipcMain.on('open-save-resume-path', (event, arg) => {
  dialog
    .showOpenDialog({
      properties: ['openDirectory'],
    })
    .then((result) => {
      event.reply('reply-save-resume-path', result.filePaths);
    })
    .catch((err) => {
      event.reply('reply-save-resume-path', err);
    });
});
```

ç„¶åé‡æ–°è¿è¡Œä¸€ä¸‹åº”ç”¨ï¼Œæ­¤æ—¶ç‚¹å‡»â€œæ›´æ”¹è·¯å¾„â€ï¼Œå¯ä»¥çœ‹åˆ°å¦‚æˆ‘ä»¬é¢„æœŸä¸€è‡´ã€‚å¯çœ‹æ­¤ [ğŸ‘‰ commit](https://github.com/PDKSophia/visResumeMook/commit/ed8a9b323ffd4c1d0aa27953c29f9598db96e044)

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8573b9c8ba8b49269a050e72b818ffa3~tplv-k3u1fbpfcp-watermark.image)

## å®ç°é»˜è®¤å­˜å‚¨è·¯å¾„

ä¸Šé¢æˆ‘ä»¬æ˜¯å®ç°äº†â€œæ›´æ”¹è·¯å¾„â€çš„åŠŸèƒ½ï¼Œä½†å®é™…ä¸Šï¼Œåº”ç”¨åˆæ¬¡è¿›å…¥æ—¶ï¼Œæ˜¯é»˜è®¤ä¸å­˜åœ¨å­˜å‚¨è·¯å¾„çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦èµ‹äºé»˜è®¤çš„çš„å­˜å‚¨è·¯å¾„å€¼ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°ä¸€ä¸‹æ­¤åŠŸèƒ½ç‚¹ã€‚

æˆ‘ä»¬åœ¨ `appConfig` æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å¢å…¨å±€é…ç½®é¡¹æ–‡ä»¶ï¼Œæš‚ä¸”ç§°ä¸º `global.config.json`

```json
// appConfig/global.config.json
{
  "name": "å…¨å±€é…ç½®è¡¨",
  "resumeSavePath": ""
}
```

å…ˆæ¥æ˜ç¡®ä¸€ä¸‹ï¼Œ`resumeSavePath` æ•°æ®åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ï¼š

- ä½œç”¨äºä¸»åº”ç”¨çª—å£ï¼Œåœ¨å¯¼å‡º PDF æ—¶ï¼Œä»¥æ­¤åœ°å€ä¸ºå‰æï¼Œè¿›è¡Œç®€å†æ•°æ®æ–‡ä»¶çš„å­˜å‚¨
- ä½œç”¨äºåº”ç”¨è®¾ç½®çª—å£ï¼Œç”¨äºå­˜å‚¨åœ°å€çš„å±•ç¤º

æ—¢ç„¶ä¸¤ä¸ªæµè§ˆå™¨çª—å£éƒ½éœ€è¦æ­¤æ•°æ®ï¼ˆä¸¤ä¸ªæ¸²æŸ“è¿›ç¨‹éœ€è¦è¿›è¡Œé€šä¿¡ï¼‰ï¼Œé‚£å°†æ­¤æ•°æ®æ”¾åœ¨å“ªä¸ªæ¸²æŸ“è¿›ç¨‹ç®¡ç†å‘¢ï¼Ÿå…¶å®ä¸ç®¡æ”¾åœ¨å“ªä¸ªæ¸²æŸ“è¿›ç¨‹ç®¡ç†ï¼Œéƒ½é€ƒä¸è¿‡ä¸»è¿›ç¨‹åšæ¶ˆæ¯ä¸­è½¬ã€‚

ç¬¬äºŒç« æœ‰æåˆ°ï¼Œå®˜æ–¹å¯¹äºæ¸²æŸ“è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ˜¯ä¸æä¾›ä»»ä½•æ–¹å¼çš„ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡ä¸»è¿›ç¨‹è¿›è¡Œä¸­è½¬ï¼Œä¹Ÿå°±æ˜¯ä¸»åº”ç”¨çª—å£å…ˆå‘ä¸€æ¡æ¶ˆæ¯ç»™ä¸»è¿›ç¨‹ï¼Œç„¶åä¸»è¿›ç¨‹å†å‘ç»™åº”ç”¨è®¾ç½®çª—å£ï¼ŒåŒæ—¶åº”ç”¨çª—å£åœ¨â€œæ›´æ”¹è·¯å¾„â€ä¹‹åï¼Œä¹Ÿä»¥åŒæ ·çš„æ–¹å¼å‘ŠçŸ¥ä¸»åº”ç”¨çª—å£ã€‚

ä¸‹é¢æˆ‘ç®€å•ç»™å¤§å®¶æ¼”ç¤ºä¸€ä¸‹ä»£ç ï¼š(**æ¼”ç¤ºç¤ºä¾‹ä»£ç ï¼Œæ³¨æ„çœ‹æ³¨é‡Š**)

```ts
// æ¸²æŸ“è¿›ç¨‹ï¼šä¸»åº”ç”¨çª—å£ï¼Œå‡è®¾åœ¨è·¯ç”±ç»„ä»¶

function Router() {
  useEffect(() => {
    // 1. è¯»å–åˆ°é»˜è®¤çš„å­˜å‚¨è·¯å¾„
    getAppPath().then((path: string) => {
      const defaultPath = `${path}resumeCache`;
      // 2. IPC é€šä¿¡ï¼Œå‘ŠçŸ¥ä¸»è¿›ç¨‹
      ipcRenderer.send('default-path_from_mainWindow_to_settingWindow', defaultPath);
    });
  });
}
```

```ts
// ä¸»è¿›ç¨‹

let currentSettingWindow: BrowserWindow;

function createWindow() {
  // 1. åˆ›å»ºä¸»åº”ç”¨çª—å£
  const mainWindow = new BrowserWindow({});
  // 2. åˆ›å»ºåº”ç”¨ç¨‹åºçª—å£
  const settingWindow = new BrowserWindow({});
  currentSettingWindow = settingWindow;
}

// 3. åœ¨ä¸»åº”ç”¨çª—å£è·å–é»˜è®¤è·¯å¾„ä¹‹åï¼Œç›‘å¬æ¶ˆæ¯
ipcMain.on('default-path_from_mainWindow_to_settingWindow', (event, arg) => {
  console.log('ä»ä¸»åº”ç”¨çª—å£è¿‡æ¥çš„é»˜è®¤è·¯å¾„ï¼š', arg);

  // 4. ä¸»è¿›ç¨‹ä¸­è½¬æ¶ˆæ¯ï¼ŒåŒæ­¥åˆ°åº”ç”¨è®¾ç½®çª—å£
  currentSettingWindow.webContents.on('did-finish-load', () => {
    currentSettingWindow.webContents.send('default-path_from_settingWindow_to_mainWindow', arg);
  });
});
```

```ts
// æ¸²æŸ“è¿›ç¨‹ï¼šåº”ç”¨è®¾ç½®çª—å£

function Setting() {
  useEffect(() => {
    // 1. ç›‘å¬äº‹ä»¶ï¼Œè·å–é»˜è®¤çš„åœ°å€
    ipcRenderer.on('default-path_from_settingWindow_to_mainWindow', (event, arg: string) => {
      if (arg) {
        setResumeSavePath(arg);
      } else {
        console.log('è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤±è´¥');
      }
    });
  }, []);
}
```

è¿™åªæ˜¯åˆå§‹è¿›å…¥åº”ç”¨æ—¶è¯»å–é»˜è®¤å­˜å‚¨è·¯å¾„ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¿˜æœ‰â€œæ›´æ”¹è·¯å¾„â€æ“ä½œï¼Œè¿™ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œé¢‘ç¹é€šä¿¡çš„ã€‚æ‰€ä»¥è¿™ç§æ–¹å¼å›ºç„¶å¯ä»¥å®ç°ï¼Œä½†å®é™…ä¸Šä¸åˆç†ã€‚æˆ‘ä»¬æ”¾å¼ƒè¿™ç§æ–¹å¼ï¼Œæ¢ç´¢ä¸€æ¡æ­£ç¡®çš„é“è·¯ã€‚

æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œä¸»åº”ç”¨çª—å£åœ¨ä»€ä¹ˆæ—¶å€™ç”¨åˆ°è¿™ä¸ªå­—æ®µæ•°æ®ï¼Ÿåœ¨å¯¼å‡º PDF æ—¶ï¼›é‚£éœ€è¦å®æ—¶æ•°æ®å—ï¼Ÿå¹¶ä¸éœ€è¦ï¼Œåªè¦ä¿è¯åœ¨å¯¼å‡º PDF æ—¶ï¼Œè¯¥æ•°æ®æ˜¯æœ€æ–°çš„å³å¯ã€‚

æœ€ç»ˆçš„è§£å†³æ–¹æ¡ˆä¸ºï¼š**åœ¨åº”ç”¨è®¾ç½®çª—å£å¤„ç†æ‰€æœ‰ä¸å­˜å‚¨è·¯å¾„ç›¸å…³çš„å·¥ä½œï¼Œä¸»åº”ç”¨çª—å£å°±åªéœ€è¦è¯»å–å…¨å±€é…ç½®è¡¨æ–‡ä»¶å†…å®¹å³å¯ã€‚**

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8fcfd628bf54db6bd2ab4b4078c5c74~tplv-k3u1fbpfcp-watermark.image)

åœ¨ä¿®æ”¹æ›´æ”¹å­˜å‚¨è·¯å¾„ä¸Šï¼Œä¹Ÿæ˜¯é€šè¿‡è¯»å†™æ“ä½œå…¨å±€é…ç½®è¡¨æ–‡ä»¶è¿›è¡Œå®ç°ã€‚

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/25d4456fe720427499d20e57e1c24f18~tplv-k3u1fbpfcp-watermark.image)

åœ¨ä¸»åº”ç”¨çª—å£ä¸­ï¼Œå¯¼å‡º PDF æ—¶ï¼Œè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¾—åˆ°å­˜å‚¨åœ°å€ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼š**å¦‚æœç”¨æˆ·å‹æ ¹å°±æ²¡æ‰“å¼€åº”ç”¨è®¾ç½®çª—å£ï¼Œè¿›è¡Œå­˜å‚¨è·¯å¾„çš„é…ç½®ï¼Œé‚£ä¹ˆéœ€è¦ç»™å®šä¸€ä¸ªé»˜è®¤åœ°å€ã€‚**

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8638639ca99e4cafa01af65a0f0b7ca5~tplv-k3u1fbpfcp-watermark.image)

## åœ¨åº”ç”¨è®¾ç½®çª—å£è¯»å–é»˜è®¤é…ç½®å¹¶æ”¯æŒæ›´æ”¹è·¯å¾„

æˆ‘ä»¬å‰å¾€ `renderer/hooks` æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å¢ `useGlobalConfigActionHooks.ts
.ts` æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯å¯¹å…¨å±€é…ç½®æ–‡ä»¶çš„è¯»å–çš„æ›´æ–°

```ts
// renderer/hooks/useGlobalConfigActionHooks.ts

import path from 'path';
import fileAction from '@common/utils/file';
import { getAppPath } from '@common/utils/appPath';

/**
 * @description è¯»å–å…¨å±€é…ç½®æ–‡ä»¶çš„å†…å®¹
 */
export function useReadGlobalConfigFile() {
  return () => {
    return new Promise((resolve: (values: { [key: string]: any }) => void, reject: (value: Error) => void) => {
      getAppPath().then((appPath: string) => {
        const jsonPath = path.join(appPath, 'appConfig/global.config.json');
        fileAction
          .hasFile(jsonPath)
          .then(async () => {
            const themeConfigValues = await fileAction.read(jsonPath, 'utf-8');
            resolve(JSON.parse(themeConfigValues));
          })
          .catch(() => {
            reject(new Error('appConfig does not exist !'));
          });
      });
    });
  };
}

/**
 * @description è¯»å–é…ç½®æ–‡ä»¶çš„å†…å®¹
 * @param {string} updateKey é”®
 * @param {any} updateValues å€¼
 * @param {function} callback å›è°ƒå‡½æ•°
 */
export function useUpdateGlobalConfigFile() {
  const readGlobalConfigFile = useReadGlobalConfigFile();
  return (updateKey: string, updateValues: any, callback?: () => void) => {
    getAppPath().then((appPath: string) => {
      const jsonPath = path.join(appPath, 'appConfig/global.config.json');
      readGlobalConfigFile().then((values: { [key: string]: any }) => {
        if (values && !!Object.keys(values).length) {
          const nextConfigContent = {
            ...values,
            [`${updateKey}`]: updateValues,
          };
          fileAction.canWrite(jsonPath).then(() => {
            fileAction.write(jsonPath, nextConfigContent, 'utf-8').then(() => {
              callback && callback();
            });
          });
        }
      });
    });
  };
}
```

æ¥ç€æˆ‘ä»¬å‰å¾€ `renderer/windowPages/setting/index.tsx`ï¼Œä¿®æ”¹ä¸€ä¸‹æˆ‘ä»¬çš„æ–‡ä»¶å†…å®¹ï¼Œæ³¨æ„çœ‹æ³¨é‡Šå†…å®¹ï¼ˆä¼ªä»£ç ï¼‰

```ts
// renderer/windowPages/setting/index.tsx

import React, { useState, useEffect } from 'react';
import './index.less';
import { ipcRenderer } from 'electron';
import { getAppPath } from '@common/utils/appPath';
import { useReadGlobalConfigFile, useUpdateGlobalConfigFile,} from '@src/hooks/useGlobalConfigActionHooks';

function Setting() {
  const [resumeSavePath, setResumeSavePath] = useState('');
  // ğŸ‘‡ 1. å¼•å…¥ Hooksï¼Œè¿›è¡Œè¯»å–æ–‡ä»¶å†…å®¹å’Œæ›´æ–°å†…å®¹
  const readAppConfigThemeFile = useReadGlobalConfigFile();
  const updateGlobalConfigFile = useUpdateGlobalConfigFile();

  // ğŸ‘‡ 2. åœ¨ didMount å‘¨æœŸæ—¶ï¼Œè¯»å–é…ç½®æ–‡ä»¶å†…å®¹
  useEffect(() => {
    readAppConfigThemeFile().then((value: { [key: string]: any }) => {
      // ğŸ‘‡ 2.1 å¦‚æœå­˜åœ¨é»˜è®¤è·¯å¾„ï¼Œä»¥æ­¤ä¸ºä¸»
      if (value?.resumeSavePath) {
        setResumeSavePath(value?.resumeSavePath);
      } else {
        // ğŸ‘‡ 2.2 ä¸å­˜åœ¨é»˜è®¤è·¯å¾„ï¼Œåˆ™è®¾ç½®é»˜è®¤è·¯å¾„å¹¶æ›´æ–°æ–‡ä»¶å†…å®¹
        getAppPath().then((appPath: string) => {
          setResumeSavePath(`${appPath}resumeCache`);
          updateGlobalConfigFile('resumeSavePath', `${appPath}resumeCache`);
        });
      }
    });
  }, []);

  // ğŸ‘‡ 3. æ›´æ”¹å­˜å‚¨è·¯å¾„ï¼Œå‘èµ· IPC é€šä¿¡
  const onChangePath = () => {
    // 3.1 å‘ä¸»è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œå› ä¸º dialog æ¨¡å—åªèƒ½åœ¨ä¸»è¿›ç¨‹ä¸­è°ƒç”¨
    ipcRenderer.send('open-save-resume-path', '');
    // 3.2 ç›‘å¬ä»ä¸»è¿›ç¨‹å‘é€å›æ¥çš„æ¶ˆæ¯
    ipcRenderer.on('reply-save-resume-path', (event, arg: string[]) => {
      if (arg) {
        // 3.3 è®¾ç½®æœ€æ–°å­˜å‚¨è·¯å¾„ï¼Œå¹¶æ›´æ–°æ–‡ä»¶å†…å®¹
        if (arg.length > 0) {
          setResumeSavePath(arg[0]);
          updateGlobalConfigFile('resumeSavePath', arg[0]);
        }
      } else {
        console.log('è‡ªå®šä¹‰å­˜å‚¨è·¯å¾„å¤±è´¥');
      }
    });
  };
}

export default Setting;
```

æ¥ç€åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œçœ‹çœ‹æ˜¯å¦ä¸æˆ‘ä»¬æœŸæœ›ä¸€è‡´ï¼Ÿç»è¿‡éªŒè¯ï¼Œæ˜¯æ²¡é—®é¢˜çš„ã€‚æ¥ä¸‹æ¥å°±æ˜¯ä¸»åº”ç”¨åœ¨å¯¼å‡º PDF æ—¶çš„å·¥ä½œå¤„ç†äº†ã€‚

## åœ¨ä¸»åº”ç”¨çª—å£å¯¼å‡ºæ—¶è¿›è¡Œå­˜å‚¨

æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°å¯¼å‡º PDF æ—¶ï¼Œä»¥ json æ–‡ä»¶å½¢å¼å­˜å‚¨æˆ‘ä»¬çš„ç®€å†æ•°æ®

> æ–‡ä»¶æ ¼å¼ä»¥ `å¹´æœˆæ—¥_å§“å_å­¦æ ¡_å²—ä½_${UUID}` å‘½åã€‚

æˆ‘ä»¬å‰å¾€ `renderer/container/resume/ResumeAction`ï¼Œä¿®æ”¹`index.tsx` ä¸­çš„å¯¼å‡ºå›è°ƒå‡½æ•°

```ts
// renderer/container/resume/ResumeAction/index.tsx

import { toPrintPdf } from '@common/utils/htmlToPdf';
import fileAction from '@common/utils/file';
import { createUID } from '@common/utils';
import { intToDateString } from '@common/utils/time';
import { getAppPath } from '@common/utils/appPath';
import { useReadGlobalConfigFile, useUpdateGlobalConfigFile } from '@src/hooks/useGlobalConfigActionHooks';

function ResumeAction() {
  const [showModal, setShowModal] = useState(false);
  const base: TSResume.Base = useSelector((state: any) => state.resumeModel.base);
  const work: TSResume.Work = useSelector((state: any) => state.resumeModel.work);
  const resume = useSelector((state: any) => state.resumeModel);

  // ğŸ‘‡ 1. å¼•å…¥ Hooks
  const readAppConfigThemeFile = useReadGlobalConfigFile();
  const updateGlobalConfigFile = useUpdateGlobalConfigFile();

  // å¯¼å‡ºPDF
  const exportPdf = () => {
    toPrintPdf(`${base?.username}+${base?.school}+${work?.job}`);
    setShowModal(false);
    readAppConfigThemeFile().then((value: { [key: string]: any }) => {
      if (value?.resumeSavePath) {
        saveResumeJson(value?.resumeSavePath);
      } else {
        // ğŸ‘‡ 2.2 ä¸å­˜åœ¨é»˜è®¤è·¯å¾„ï¼Œåˆ™è®¾ç½®é»˜è®¤è·¯å¾„å¹¶æ›´æ–°æ–‡ä»¶å†…å®¹
        getAppPath().then((appPath: string) => {
          updateGlobalConfigFile('resumeSavePath', `${appPath}resumeCache`);
          saveResumeJson(`${appPath}resumeCache`);
        });
      }
    });
  };

  // å­˜å‚¨æ•°æ®json
  const saveResumeJson = (resumeSavePath: string) => {
    const date = intToDateString(new Date().valueOf(), '_');
    const prefix = `${date}_${base?.username}_${base?.school}_${work?.job}_${createUID()}.json`;
    // å¦‚æœè·¯å¾„ä¸­ä¸å­˜åœ¨ resumeCache æ–‡ä»¶å¤¹ï¼Œåˆ™é»˜è®¤åˆ›å»ºæ­¤æ–‡ä»¶å¤¹
    if (resumeSavePath && resumeSavePath.search('resumeCache') > -1) {
      fileAction?.write(`${resumeSavePath}/${prefix}`, resume, 'utf8');
    } else {
      fileAction
        ?.mkdirDir(`${resumeSavePath}/resumeCache`)
        .then((path) => {
          if (path) fileAction?.write(`${path}/${prefix}`, resume, 'utf8');
        })
        .catch(() => {
          console.log('åˆ›å»ºæ–‡ä»¶å¤¹å¤±è´¥');
        });
    }
  };
}

export default ResumeAction;
```

ä¸å‡ºæ„å¤–çš„è¯ï¼Œæ­¤æ—¶çš„ä½ ä¼šæŠ¥é”™ï¼ŒåŸå› æ˜¯æ‰¾ä¸åˆ° `fileAction.mkdirDir()` æ–¹æ³•ï¼ŒåŸæ¥åœ¨[ç¬¬ä¸ƒç« èŠ‚](https://juejin.cn/book/6950646725295996940/section/6962906314565484551)æˆ‘ä»¬å°è£…çš„ file.ts æ–‡ä»¶ä¸­æœªæ”¯æŒ mkdirDirï¼Œæˆ‘ä»¬å‰å¾€ `@common/utils/file.ts`ï¼Œæ·»åŠ ä¸€ä¸‹ä»£ç ã€‚

```ts
const fileAction = {
  /**
   * @description åˆ›å»ºæ–‡ä»¶å¤¹
   * @param path åˆ›å»º /a/b/cï¼Œä¸ç®¡`/a` å’Œ /a/b æ˜¯å¦å­˜åœ¨ã€‚
   * @returns {Promise}
   */
  mkdirDir: (path: string): Promise<string | undefined> => {
    return fsPromiseAPIs.mkdir(path, { recursive: true });
  },
};
```

æ¥ç€æˆ‘ä»¬åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œçœ‹çœ‹æ•ˆæœå¦‚ä½•ã€‚ä¸å­˜æ„å¤–ï¼Œä¼šåœ¨ä½ é€‰ä¸­çš„æ–‡ä»¶å¤¹ä¸‹ï¼Œå­˜åœ¨ä¸€ä¸ª resumeCache æ–‡ä»¶å¤¹

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6f07e0f49def4556809784f74528431d~tplv-k3u1fbpfcp-watermark.image)

## æœ€å

æ­¤ç« èŠ‚ä»¥å¸¦ç€å°ä¼™ä¼´å®ç° Webpack å…¥å£ä¸åˆ›å»ºå¤šä¸ªæ¸²æŸ“è¿›ç¨‹åŠæµè§ˆå™¨çª—å£ï¼Œé€šè¿‡å®ç°åº”ç”¨è®¾ç½®çš„å­˜å‚¨è·¯å¾„ï¼Œä»è€Œç°è±¡ç®€å†æ•°æ®å­˜å‚¨çš„æœ€ç»ˆæ•ˆæœã€‚

æœ¬ç« èŠ‚æœ€ä¸ºé‡è¦çš„åœ¨äºä¸»è¿›ç¨‹å¤„çš„åˆ›å»ºæ¸²æŸ“è¿›ç¨‹ï¼Œä»¥åŠè¿›ç¨‹é—´é€šä¿¡ï¼Œå½“ç„¶è¿˜æœ‰è¿˜å µå…¨å±€é…ç½®æ–‡ä»¶çš„é»˜è®¤è·¯å¾„èµ‹å€¼ä¸æ›´æ”¹è·¯å¾„ï¼Œç« èŠ‚ç¯‡å¹…æœ‰é™ï¼Œå°ä¼™ä¼´ä»¬ä¸€å®šè¦ç»“åˆ[çº¿ä¸Šä»£ç ](https://github.com/PDKSophia/visResumeMook/tree/chapter-17)è¿›è¡Œé…å¥—å­¦ä¹ ã€‚

**å¦‚æœæ‚¨åœ¨è¾¹é˜…è¯»è¾¹å®è·µæ—¶ï¼Œå‘ç°ä»£ç æŠ¥é”™æˆ–è€… TS æŠ¥é”™ï¼Œé‚£ä¹ˆå°ä¼™ä¼´ä»¬å¯ä»¥æ ¹æ®æŠ¥é”™ä¿¡æ¯ï¼Œå»çº¿ä¸Šçœ‹çœ‹ç›¸åº”çš„ä»£ç ã€‚**

æœ¬ç« èŠ‚çš„ä»£ç é‡ç›¸å¯¹è¾ƒå¤§ï¼Œå¦‚æœå¯¹æœ¬ç« èŠ‚å­˜åœ¨ç–‘é—®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚
