---
title: ç¬¬82ç« ReactFlowæŒ¯è¡å™¨è°ƒéŸ³æµç¨‹å›¾ç»˜åˆ¶
date: 2025-03-02T21:28:00+08:00
description: "Reacté€šå…³ç§˜ç±ï¼Œç¬¬82ç« ReactFlowæŒ¯è¡å™¨è°ƒéŸ³æµç¨‹å›¾ç»˜åˆ¶"
categories: ['Reacté€šå…³ç§˜ç±']
tags: ['Reacté€šå…³ç§˜ç±']
artid: "1741706069"
image:
    path: https://bing.ee123.net/img/rand?artid=1741706069
    alt: ç¬¬82ç« ReactFlowæŒ¯è¡å™¨è°ƒéŸ³æµç¨‹å›¾ç»˜åˆ¶
featuredImage: https://bing.ee123.net/img/rand?artid=1741706069
featuredImagePreview: https://bing.ee123.net/img/rand?artid=1741706069
cover: https://bing.ee123.net/img/rand?artid=1741706069
image: https://bing.ee123.net/img/rand?artid=1741706069
img: https://bing.ee123.net/img/rand?artid=1741706069
---

ï»¿è¿™èŠ‚æˆ‘ä»¬æ¥ç”»ä¸‹æµç¨‹å›¾ã€‚

åˆ›å»ºä¸ªé¡¹ç›®ï¼š

```
npx create-vite audio-flow
```
![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/30cae15096b44744b26151112dd972c2~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=768&h=392&s=68531&e=png&b=000000)

è¿›å…¥é¡¹ç›®ï¼Œå®‰è£…ä¸‹ reactflow

```
npm install
npm install --save @xyflow/react
```
å»æ‰ index.css


![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a87fd063b37843b994fee7dfe1d47fbf~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1094&h=492&s=90816&e=png&b=1f1f1f)

ç„¶åæ”¹ä¸‹ App.tsx

```javascript
import { addEdge, Background, BackgroundVariant, Connection, Controls, MiniMap, OnConnect, ReactFlow, useEdgesState, useNodesState } from '@xyflow/react';
import '@xyflow/react/dist/style.css';
 
const initialNodes = [
  { id: '1', position: { x: 0, y: 0 }, data: { label: '1' } },
  { id: '2', position: { x: 0, y: 100 }, data: { label: '2' } },
];
const initialEdges = [{ id: 'e1-2', source: '1', target: '2' }];
 
export default function App() {
  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);
  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);
 
  const onConnect = (params: Connection) => {
    setEdges((eds) => addEdge(params, eds))
  }

  return (
    <div style={{ width: '100vw', height: '100vh'}}>
      <ReactFlow 
        nodes={nodes}
        edges={edges}
        onNodesChange={onNodesChange}
        onEdgesChange={onEdgesChange}
        onConnect={onConnect}
      >
        <Controls/>
        <MiniMap/>
        <Background variant={BackgroundVariant.Lines}/>
      </ReactFlow>
    </div>
  );
}
```
æˆ‘ä»¬å†™äº†ä¸‹åŸºç¡€ä»£ç ï¼ŒåŠ äº†ä¸¤ä¸ª nodeï¼Œä¸€ä¸ª edgeï¼Œç„¶ååŠ äº† Controlesã€Backgroundã€MiniMap ç»„ä»¶ã€‚

è·‘èµ·æ¥çœ‹ä¸€ä¸‹ï¼š

```
npm run dev
```
![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b99a835c6e77470a9bc229caf4201bc6~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=902&h=318&s=44154&e=png&b=191919)


![2024-08-29 14.42.48.gif](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c563c767f9fb43b299fcf7585e3913ab~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2542&h=1324&s=435924&e=gif&f=64&b=fafafa)

æ²¡å•¥é—®é¢˜ï¼Œåªæ˜¯æµç¨‹å›¾ä¸åœ¨æ­£ä¸­å¤®ã€‚

åŠ ä¸ª fitView å°±å¥½äº†ï¼š

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50be05ae1e024d829c491d948f346f9c~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1050&h=754&s=125377&e=png&b=1f1f1f)

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4d8c9b0e7fa14b869df829171fef1607~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2492&h=1406&s=102007&e=png&b=fefefe)

æ¥ä¸‹æ¥åˆ†åˆ«å®ç°è¿™ä¸‰ç§è‡ªå®šä¹‰èŠ‚ç‚¹ï¼š

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e08043d8a6d4ec9bcfbe2f2b5480fe1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1026&h=826&s=146957&e=png&b=fdfdfd)

æˆ‘ä»¬ç”¨ tailwind æ¥å†™æ ·å¼ã€‚

æŒ‰ç…§ [tailwind æ–‡æ¡£](https://www.tailwindcss.cn/docs/guides/vite#react)é‡Œçš„æ­¥éª¤å®‰è£… tailwindï¼š

```javascript
npm install -D tailwindcss postcss autoprefixer

npx tailwindcss init -p
```

ä¼šç”Ÿæˆ tailwind å’Œ postcss é…ç½®æ–‡ä»¶ï¼š

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/36df8c8c90d64b1b956c8072ffb60459~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=988&h=176&s=60899&e=png&b=1a1a1a)

ä¿®æ”¹ä¸‹ content é…ç½®ï¼Œä¹Ÿå°±æ˜¯ä»å“ªé‡Œæå– classNameï¼š

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```
tailwind ä¼šæå– className ä¹‹åæŒ‰éœ€ç”Ÿæˆæœ€ç»ˆçš„ cssã€‚

æ”¹ä¸‹ index.css å¼•å…¥ tailwind åŸºç¡€æ ·å¼ï¼š

```css
@tailwind base;
@tailwind components;
@tailwind utilities;
```
åœ¨ main.tsx é‡Œå¼•å…¥ï¼š

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/57edcbbb36c7466cabfc087c00137d94~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1074&h=488&s=91270&e=png&b=1f1f1f)

å¦‚æœä½ æ²¡å®‰è£… tailwind æ’ä»¶ï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹ï¼š

![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e7dfdd931a6946cfa629042c07b10e04~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1902&h=838&s=411909&e=png&b=1d1d1d)

è¿™æ ·åœ¨å†™ä»£ç çš„æ—¶å€™å°±ä¼šæç¤º className å’Œå¯¹åº”çš„æ ·å¼å€¼ï¼š

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c6aaecb875c4c289e7ab14562733ec9~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1194&h=576&s=72772&e=png&b=1f1f1f)

ä¸çŸ¥é“ className å«å•¥çš„æ ·å¼ï¼Œè¿˜å¯ä»¥åœ¨ [tailwind æ–‡æ¡£](https://www.tailwindcss.cn/docs/border-width)é‡Œæœï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f7efbcb935b94005b51dbd4f4faed5b7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1716&h=1218&s=333844&e=png&b=ffffff)

æ¥ä¸‹æ¥åˆ›å»ºæŒ¯è¡å™¨çš„è‡ªå®šä¹‰èŠ‚ç‚¹ï¼š

components/OscillatorNode.tsx

```javascript
import { Handle, Position } from '@xyflow/react';

export interface OscillatorNodeProps {
  id: string
  data: {
    frequency: number
    type: string
  }
}

export function OscillatorNode({ id, data }: OscillatorNodeProps) {
    return (
      <div className={'bg-white shadow-xl'}>
          <p className={'rounded-t-md p-[8px] bg-pink-500 text-white'}>æŒ¯è¡å™¨èŠ‚ç‚¹</p>
          <div className={'flex flex-col p-[8px]'}>
            <span>é¢‘ç‡</span>
            <input
                type="range"
                min="10"
                max="1000"
                value={data.frequency}
            />
            <span className={'text-right'}>{data.frequency}èµ«å…¹</span>
          </div>
          <hr className={'mx-[4px]'} />
          <div className={'flex flex-col p-[8px]'}>
            <p>æ³¢å½¢</p>
            <select value={data.type}>
              <option value="sine">æ­£å¼¦æ³¢</option>
              <option value="triangle">ä¸‰è§’æ³¢</option>
              <option value="sawtooth">é”¯é½¿æ³¢</option>
              <option value="square">æ–¹æ³¢</option>
            </select>
          </div>
          <Handle type="source" position={Position.Bottom} />
      </div>
    );
};
```
å°±æ˜¯ä¸€ä¸ªæ ‡é¢˜ï¼Œä¸€ä¸ª inputï¼Œä¸€ä¸ª selectï¼Œç”¨ tailwind å†™ä¸‹æ ·å¼ã€‚

å¯ä»¥é€šè¿‡ data ä¼ å…¥ frequencyã€type

ç”¨ä¸€ä¸‹ï¼š

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8366155f090e4f85a7e3f0725af7fbfc~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1808&h=1306&s=313143&e=png&b=1f1f1f)

```javascript
import { addEdge, Background, BackgroundVariant, Connection, Controls, MiniMap, OnConnect, ReactFlow, useEdgesState, useNodesState } from '@xyflow/react';
import '@xyflow/react/dist/style.css';
import { OscillatorNode } from './components/OscillatorNode';
 
const initialNodes = [
  { id: '1', position: { x: 0, y: 0 }, data: { frequency: 300, type: 'square' }, type: 'osc' },
  { id: '2', position: { x: 0, y: 300 }, data: { label: '2' } },
];
const initialEdges = [{ id: 'e1-2', source: '1', target: '2' }];

const nodeTypes = {
  'osc': OscillatorNode
}

export default function App() {
  const [nodes, setNodes, onNodesChange] = useNodesState(initialNodes);
  const [edges, setEdges, onEdgesChange] = useEdgesState(initialEdges);
 
  const onConnect = (params: Connection) => {
    setEdges((eds) => addEdge(params, eds))
  }

  return (
    <div style={{ width: '100vw', height: '100vh'}}>
      <ReactFlow 
        nodes={nodes}
        edges={edges}
        onNodesChange={onNodesChange}
        onEdgesChange={onEdgesChange}
        onConnect={onConnect}
        nodeTypes={nodeTypes}
        fitView
      >
        <Controls/>
        <MiniMap/>
        <Background variant={BackgroundVariant.Lines}/>
      </ReactFlow>
    </div>
  );
}
```
çœ‹ä¸‹æ•ˆæœï¼š
![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bea6701ec8804c59a4e8fa88ffaa7da7~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2622&h=1484&s=179746&e=png&b=fefefe)

å¯ä»¥çœ‹åˆ°ï¼ŒèŠ‚ç‚¹æ›¿æ¢ä¸ºäº†æˆ‘ä»¬è‡ªå®šä¹‰çš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ ¹æ®ä¼ å…¥çš„ data åšäº†è¡¨å•å›æ˜¾ã€‚

æ¥ä¸‹æ¥å†™ä¸‹ç¬¬äºŒç§è‡ªå®šä¹‰èŠ‚ç‚¹ï¼š

components/VolumeNode.tsx

```javascript
import { Handle, Position } from '@xyflow/react';

export interface VolumeNodeProps {
  id: string
  data: {
    gain: number
  }
}

export function VolumeNode({ id, data }: VolumeNodeProps) {
    return (
        <div className={'rounded-md bg-white shadow-xl'}>
            <Handle type="target" position={Position.Top} />

            <p className={'rounded-t-md p-[4px] bg-blue-500 text-white'}>éŸ³é‡èŠ‚ç‚¹</p>
            <div className={'flex flex-col p-[4px]'}>
                <p>Gain</p>
                <input
                    type="range"
                    min="0"
                    max="1"
                    step="0.01"
                    value={data.gain}
                />
                <p className={'text-right'}>{data.gain.toFixed(2)}</p>
            </div>

            <Handle type="source" position={Position.Bottom} />
        </div>
    );
}
```

ä¸»è¦æ˜¯ä¸Šä¸‹ä¸¤ä¸ª Handleã€ä¸­é—´ä¸€ä¸ª inputã€‚

ç”¨ä¸€ä¸‹ï¼š

![](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4cd29cc3fae0457da24fed96bcde1ca1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1790&h=1256&s=332726&e=png&b=1f1f1f)

```javascript
const initialNodes = [
  { id: '1', position: { x: 0, y: 0 }, data: { frequency: 300, type: 'square' }, type: 'osc' },
  { id: '2', position: { x: 0, y: 300 }, data: { gain: 0.6 }, type: 'volume' },
];
const initialEdges = [{ id: 'e1-2', source: '1', target: '2' }];

const nodeTypes = {
  'osc': OscillatorNode,
  'volume': VolumeNode
}
```
çœ‹ä¸‹æ•ˆæœï¼š

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/11b8adac194d4d0fb59154ec3a4f737a~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2328&h=1436&s=177606&e=png&b=fdfdfd)

å¯ä»¥çœ‹åˆ°ï¼ŒéŸ³é‡èŠ‚ç‚¹ä¹Ÿæ¸²æŸ“å‡ºæ¥äº†ã€‚

ç„¶åæ¥å†™æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼šè¾“å‡ºèŠ‚ç‚¹

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e08043d8a6d4ec9bcfbe2f2b5480fe1~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1026&h=826&s=146957&e=png&b=fdfdfd)

components/OutputNode.tsx

```javascript
import { Handle, Position } from '@xyflow/react';
import { useState } from 'react';

export function OutputNode() {
    const [isRunning, setIsRuning] = useState(false);

    function toggleAudio() {
        setIsRuning(isRunning => !isRunning)
    }

    return <div className={'bg-white shadow-xl p-[20px]'}>
        <Handle type="target" position={Position.Top} />

        <div>
            <p>è¾“å‡ºèŠ‚ç‚¹</p>
            <button onClick={toggleAudio}>
                {isRunning ? (
                    <span role="img">
                    ğŸ”ˆ
                    </span>
                ) : (
                    <span role="img">
                    ğŸ”‡
                    </span>
                )}
            </button>
        </div>
    </div>
}
```
ç”¨ä¸€ä¸‹ï¼š

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ae8066712a01404f8c4386d3b36eeba0~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=1786&h=1262&s=349579&e=png&b=1f1f1f)

åŠ ä¸€ä¸ªèŠ‚ç‚¹ç±»å‹ï¼Œç„¶ååŠ ä¸€ä¸ªèŠ‚ç‚¹ã€ä¸€æ¡è¾¹ã€‚

```javascript
const initialNodes = [
  { id: '1', position: { x: 0, y: 0 }, data: { frequency: 300, type: 'square' }, type: 'osc' },
  { id: '2', position: { x: 0, y: 300 }, data: { gain: 0.6 }, type: 'volume' },
  { id: '3', position: { x: 0, y: 500 }, data: { }, type: 'out' },
];
const initialEdges = [
  { id: 'e1-2', source: '1', target: '2' },
  { id: 'e2-3', source: '2', target: '3' },
];

const nodeTypes = {
  'osc': OscillatorNode,
  'volume': VolumeNode,
  'out': OutputNode
}
```

çœ‹ä¸‹æ•ˆæœï¼š

![image.png](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d6253ff52e9b4cd5a2f386e6aab015de~tplv-k3u1fbpfcp-jj-mark:0:0:0:0:q75.image#?w=2724&h=1480&s=204984&e=png&b=fdfdfd)

è¿™æ ·ï¼Œä¸‰ç§è‡ªå®šä¹‰èŠ‚ç‚¹å°±éƒ½ç”»å‡ºæ¥äº†ã€‚

æ¡ˆä¾‹ä»£ç ä¸Šä¼ äº†[å°å†Œä»“åº“](https://github.com/QuarkGluonPlasma/react-course-code/tree/main/audio-flow)

## æ€»ç»“

æˆ‘ä»¬åˆ›å»ºäº† vite é¡¹ç›®ï¼Œå¼•å…¥äº† tailwind æ¥å†™æ ·å¼ã€‚

ç„¶åå®ç°äº†æµç¨‹å›¾çš„ç»˜åˆ¶ï¼Œä¸»è¦æ˜¯ä¸‰ç§è‡ªå®šä¹‰èŠ‚ç‚¹çš„ç»˜åˆ¶ï¼š

æŒ¯è¡å™¨èŠ‚ç‚¹ã€éŸ³é‡èŠ‚ç‚¹ã€è¾“å‡ºèŠ‚ç‚¹ã€‚

æµç¨‹å›¾ç”»å®Œäº†ï¼Œä¸‹èŠ‚æ¥å¼€å‘éŸ³é¢‘éƒ¨åˆ†çš„åŠŸèƒ½ã€‚
